<header>
  <div class="nav-container">
    <div class="navbar-brand">
      <a routerLink="/" class="home-link">
        <mat-icon>home</mat-icon>
        <span>Inicio</span>
      </a>
      <button class="menu-toggle" (click)="menuAbierto = !menuAbierto">
        <mat-icon>menu</mat-icon>
      </button>
    </div>

    <nav [class.abierto]="menuAbierto">
      <ul class="menu">
        <!-- Submen√∫ Cuentas -->
        <li class="submenu-container" (click)="toggleSubmenu('codificacion', $event)">
          <a href="">Codificaci√≥n</a>
          <ul class="submenu"[class.visible]="submenus.codificacion">
            <li><a routerLink="/contabilidad/agregar-cuenta">Catalogo de Cuentas</a></li>
            <li><a routerLink="/contabilidad/documentos">Documentos Contabilidad</a></li>
            <li><a routerLink="/contabilidad/centro-costos">Centro de Costos</a></li>
          </ul>
        </li>

        <!-- Submen√∫ Comprobante -->
        <li class="submenu-container" (click)="toggleSubmenu('transacciones', $event)">
          <a href="">Transacciones</a>
          <ul class="submenu"[class.visible]="submenus.transacciones">
            <li><a routerLink="/contabilidad/asiento-apertura">Asiento de Apertura</a></li>
            <li><a routerLink="/contabilidad/comprobante-egresos">Comprobante de Egresos</a></li>
            <li><a routerLink="/contabilidad/comprobante-ingresos">Comprobante de Ingresos</a></li>
            <li><a routerLink="/contabilidad/transaccion-general">Transacciones Generales</a></li>
            <li><a routerLink="/contabilidad/compras-varias">Compras Varias</a></li>
          </ul>
        </li>

        <!-- Submen√∫ Libro Diario -->
        <li class="submenu-container" (click)="toggleSubmenu('libros', $event)">
          <a href="">Libros Contables</a>
          <ul class="submenu"[class.visible]="submenus.libros">
            <li><a routerLink="/contabilidad/libdiario">Libro Diario</a></li>
            <li><a routerLink="/contabilidad/libmayor">Libro Mayor</a></li>
          </ul>
        </li>

        <!-- Enlaces restantes -->
        <li><a routerLink="/contabilidad/estados">Estados Financieros</a></li>
        <li><a routerLink="/contabilidad/estado-resultados">Estado de Resultados</a></li>
        <li><a routerLink="/contabilidad/balances">Balances de comprobaci√≥n</a></li>
      </ul>
    </nav>
  </div>
</header>



  <div id="preloader">
    <div class="preloader">
      <span></span><span></span><span></span><span></span>
    </div>
  </div>
  
  <div class="cuentas-container">
    <h5>Cat√°logo de Cuentas</h5>
  
    <!-- Formulario de nueva cuenta -->
    <form [formGroup]="formCuenta" (ngSubmit)="agregarCuenta()" class="form-cuenta">
      <div class="form-group">
        <label for="codigo">C√≥digo</label>
        <input type="text" formControlName="codigo" id="codigo" placeholder="Ej. 110101.01" />
      </div>
  
      <div class="form-group">
        <label for="nombre">Nombre</label>
        <input type="text" formControlName="nombre" id="nombre" placeholder="Ej. Caja General" />
      </div>
  
      <div class="form-group">
        <label for="tipo">Tipo</label>
        <select formControlName="tipo" id="tipo">
          <option value="">Seleccione</option>
          <option value="Activo">Activo</option>
          <option value="Pasivo">Pasivo</option>
          <option value="Patrimonio">Patrimonio</option>
          <option value="Ingreso">Ingreso</option>
          <option value="Gasto">Gasto</option>
        </select>
      </div>
  
      <button type="submit" [disabled]="formCuenta.invalid">Agregar Cuenta</button>
    </form>
  
    <!-- Bot√≥n para mostrar/ocultar tabla -->
    <div class="acciones-catalogo">
      <button (click)="verCuentasRegistradas()" class="btn-ver">
        üìÅ {{ mostrarTabla ? 'Ocultar cuentas' : 'Ver cuentas registradas' }}
      </button>
    </div>
  
    <!-- Filtros y tabla -->
    <div *ngIf="mostrarTabla">
      <div class="cuentasfiltradas">
        <input
          type="text"
          [(ngModel)]="busqueda"
          name="busqueda"
          placeholder="üîç Buscar por nombre o c√≥digo"
          class="buscador"
        />
  
        <select [(ngModel)]="filtroTipo" name="filtroTipo" class="filtro-select">
          <option value="">Todos los tipos</option>
          <option *ngFor="let tipo of tiposCuenta" [value]="tipo">{{ tipo }}</option>
        </select>
      </div>
  
      <div class="tabla-cuentas" *ngIf="cuentasFiltradas.length > 0">
        <h3>Listado de Cuentas Registradas</h3>
        <table>
          <thead>
            <tr>
              <th>C√≥digo</th>
              <th>Nombre</th>
              <th>Tipo</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let cuenta of cuentasPaginadas">
              <td>
                <ng-container *ngIf="cuentaEnEdicion === cuenta.id; else soloCodigo">
                  <input type="text" [(ngModel)]="cuentaEditada.codigo" name="codigoEditado" />
                </ng-container>
                <ng-template #soloCodigo>{{ cuenta.codigo }}</ng-template>
              </td>
  
              <td>
                <ng-container *ngIf="cuentaEnEdicion === cuenta.id; else soloNombre">
                  <input type="text" [(ngModel)]="cuentaEditada.nombre" name="nombreEditado" />
                </ng-container>
                <ng-template #soloNombre>{{ cuenta.nombre }}</ng-template>
              </td>
  
              <td>
                <ng-container *ngIf="cuentaEnEdicion === cuenta.id; else soloTipo">
                  <select [(ngModel)]="cuentaEditada.tipo" name="tipoEditado">
                    <option value="Activo">Activo</option>
                    <option value="Pasivo">Pasivo</option>
                    <option value="Patrimonio">Patrimonio</option>
                    <option value="Ingreso">Ingreso</option>
                    <option value="Gasto">Gasto</option>
                  </select>
                </ng-container>
                <ng-template #soloTipo>{{ cuenta.tipo }}</ng-template>
              </td>
  
              <td>
                <ng-container *ngIf="cuentaEnEdicion === cuenta.id; else accionesDefault">
                  <button (click)="guardarEdicion(cuenta.id)" class="btn-guardar">Guardar</button>
                  <button (click)="cancelarEdicion()" class="btn-cancelar">Cancelar</button>
                </ng-container>
                <ng-template #accionesDefault>
                  <button (click)="editarCuenta(cuenta)" class="btn-editar">Editar</button>
                  <button (click)="eliminarCuenta(cuenta.id)" class="btn-eliminar">Eliminar</button>
                </ng-template>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="paginacion-footer" *ngIf="totalPaginas > 1">
          <button (click)="cambiarPagina(paginaActual - 1)" [disabled]="paginaActual === 1">‚èÆ Anterior</button>
        
          <span *ngFor="let i of [].constructor(totalPaginas); let idx = index">
            <button (click)="cambiarPagina(idx + 1)" [class.activo]="paginaActual === idx + 1">
              {{ idx + 1 }}
            </button>
          </span>
        
          <button (click)="cambiarPagina(paginaActual + 1)" [disabled]="paginaActual === totalPaginas">Siguiente ‚è≠</button>
        </div>
      </div>
  
      <p *ngIf="cuentasFiltradas.length === 0">üîç No hay cuentas que coincidan con los filtros.</p>
    </div>
  </div>
  